# Environment setup

This readme file describes the working of the environment setup. 
Additionally, it makes sure that the environments directory is made persistent as it is not generated by the scripts.

## Environment configuration

script bk2/set-env.js is called with 

```sh
ts-node ./set-env.js
```

to generate environment.ts for test environment and environment.prod.ts for prod environment.
see target config in bk2/apps/{APPDIR}/project.json

DO NOT COMMIT THIS FILE INTO YOUR SOURCE CODE MANAGEMENT SYSTEM AS IT CONTAINS SENSITIVE INFORMATION.

### Environment parameters in productive environment

In prod environment with Firebase AppHosting deployment, the environment parameters are read from Google Cloud Secrets.

Add secrets with firebase apphosting:secrets:set {SECRET_NAME} {SECRET_VALUE}.

Make sure to configure the correct permissions to make these secrets readable.

see: [how-to-keep-your-secrets-from-your-source-code-in-an-angular-project](https://pazel.dev/how-to-keep-your-secrets-from-your-source-code-in-an-angular-project)


### Environment parameters in dev/test environment

In development or test environment, the environment parameters are read from the local environment.
You can find a file bk2/apps/{APPDIR}/.env. Execute this file to write the parameters into your environment:

```sh
source ./apps/{APPDIR}/.env
```

DO NOT COMMIT THIS FILE INTO YOUR SOURCE CODE MANAGEMENT SYSTEM AS IT CONTAINS SENSITIVE INFORMATION.

## Build process

For a production build (--prod), the build script in package.json will replace the environment.ts with environment.prod.ts.

