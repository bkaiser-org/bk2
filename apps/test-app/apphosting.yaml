# Settings for Backend (on Cloud Run).
runConfig:
  minInstances: 0
  maxInstances: 10
  command: ["sh", "-c", "echo '--- Running npm start ---' && pwd && echo '--- Contents of current directory (.) ---' && ls -l . && echo '--- Contents of ./browser ---' && ls -l ./browser && npm start"] # Modified for diagnostics
  entryPoint: "dist/apps/test-app"

env:
  - variable: APP_ID
    value: test-app
  - variable: NODE_ENV
    value: production
  - variable: STREAM_API_KEY
    secret: STREAM_API_KEY
  - variable: NEXT_PUBLIC_FIREBASE_RECAPTCHA_KEY
    secret: NEXT_PUBLIC_FIREBASE_RECAPTCHA_KEY
  - variable: NEXT_PUBLIC_NX_CLOUD_ACCESS_TOKEN
    secret: NEXT_PUBLIC_NX_CLOUD_ACCESS_TOKEN
  - variable: NEXT_PUBLIC_SVC_GMAP_KEY
    secret: NEXT_PUBLIC_SVC_GMAP_KEY
  - variable: NEXT_PUBLIC_IMGIX_BASE_URL
    secret: NEXT_PUBLIC_IMGIX_BASE_URL
  - variable: IPINFO_TOKEN
    secret: IPINFO_TOKEN

buildConfig:
  buildCommand: pnpm run build
